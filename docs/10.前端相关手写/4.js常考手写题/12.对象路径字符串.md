# ðŸŽª 12.å¯¹è±¡è·¯å¾„å­—ç¬¦ä¸²



## ðŸ“Ž é¢˜ç›®æè¿°
æš‚æ— é¢˜ç›®æè¿°

## ðŸ“ƒ ä»£ç å®žçŽ°
```typescript
// å®žçŽ°ä¸€ä¸ªclassï¼Œæ»¡è¶³ä¸‹é¢çš„è¾“å‡º
class Data {
    constructor(data) {
        this.watcher = new Map() // å­—ç¬¦ä¸²ï¼Œcallbackå›žè°ƒå‡½æ•°
        this.data = data
    }
    get(str) {
        return str.split('.').reduce((acc, cur) => acc[cur], this.data)
    }
    set(str, val) {
        const keys = str.split('.')
        const lastKey = keys.pop()
        let current = this.data
        keys.forEach(key => {
            current = current[key]
        })
        current[lastKey] = val
        this.watcher.get(str).forEach(cb => cb(val))
    }
    watch(str, callback) {
        if (!this.watcher.has(str)) {
            this.watcher.set(str, new Set())
        }
        this.watcher.set(str, this.watcher.get(str).add(callback))
    }
}

const data = new Data({ a: { b: { c: { d: 4 } } } })

console.log(data.get('a.b')) // { a: { b: { c: { d: 4 } } } }
data.watch('a.b', (data) => console.log(data))
data.set('a.b', 2) // 2
```
