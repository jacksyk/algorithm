# ğŸ® 19.å°äºnçš„æœ€å¤§æ•°

[é¢˜ç›®é“¾æ¥](https://edu.51cto.com/video/27365.html)

## ğŸ“‹ é¢˜ç›®æè¿°
* @url https://edu.51cto.com/video/27365.html

## ğŸ“Œ ä»£ç å®ç°
```typescript
/**
 * @url https://edu.51cto.com/video/27365.html
 */

/**
 * @url https://blog.csdn.net/K346K346/article/details/126958310
 */

// ps: å›æº¯ ---> æš´åŠ›è§£æ³•
const findMax = (arr, num) => {
    const res = []
    const len = num.toString().length
    const dfs = (path) => {
        res.push(path)

        if (path.length === len) {
            return
        }

        for (let i = 0; i < arr.length; i++) {
            dfs(path.concat(arr[i]))
        }
    }
    dfs([])
    const res1 = res.map(item => item.join('')).filter(item => item <= num).sort((a, b) => b - a)
    return res1[0]
}
// console.log(findMax([9], 1000)) // 999
// console.log(findMax([2, 3, 4, 9], 23149)) // 22999
// console.log(findMax([2, 3, 4, 9], 23412)) // 23399

// ps: è´ªå¿ƒ
// ===========================================================
// ps: ä»é«˜ä½å¼€å§‹éå†ï¼Œå¯¹æ¯ä¸€ä½å…ˆå°è¯•ä½¿ç”¨ç›¸åŒæ•°å­—ï¼Œé™¤äº†æœ€åä¸€ä½ã€‚
// ps: å¦‚æœæ²¡æœ‰ç›¸åŒçš„æ•°å­—æ—¶ï¼Œå°è¯•æ˜¯å¦æœ‰æ¯”å½“å‰æ•°å­—æ›´å°çš„ï¼Œæœ‰çš„è¯é€‰æ›´å°çš„æ•°å­—é‡Œæœ€å¤§çš„ï¼Œå‰©ä¸‹çš„ç”¨æœ€å¤§æ•°å­—ã€‚
// ps: éƒ½æ²¡æœ‰å°±å‘å‰å›æº¯çœ‹å‰ä¸€ä¸ªæœ‰æ²¡æœ‰æ›´å°çš„ã€‚å¦‚æœä¸€ç›´å›æº¯åˆ°ç¬¬ä¸€ä¸ªæ•°å­—éƒ½æ²¡æœ‰æ›´å°çš„æ•°å­—ï¼Œå°±ç”¨ä½æ•°æ›´å°‘çš„å…¨éƒ½æ˜¯æœ€å¤§æ•°å­—çš„æ•°ã€‚

function findMaxNumber(num, arr) {
    // å°†æ•°ç»„ä»å¤§åˆ°å°æ’åº
    arr.sort((a, b) => b - a);
    const maxDigit = arr[0];  // æœ€å¤§æ•°å­—
    const digits = num.toString().length;  // è·å–ç›®æ ‡æ•°çš„ä½æ•°

    // è·å– num çš„æ¯ä¸€ä½
    const numArr = num.toString().split('').map(Number);

    // è¾…åŠ©å‡½æ•°ï¼šå°†æ•°ç»„è½¬æ¢ä¸ºæ•°å­—
    const arrayToNumber = (arr) => parseInt(arr.join(''));

    // ç»“æœæ•°ç»„
    let result = new Array(digits).fill(0);

    // ä»é«˜ä½åˆ°ä½ä½å¤„ç†
    for (let i = 0; i < digits; i++) {
        // é™¤äº†æœ€åä¸€ä½ï¼Œå…ˆå°è¯•ä½¿ç”¨å½“å‰ä½çš„æ•°å­—
        let currentDigit = (i === digits - 1) ? maxDigit : numArr[i];

        // ps: å¦‚æœå½“å‰æ•°å­—ä¸åœ¨ arr ä¸­ï¼Œæˆ–è€…ä½¿ç”¨ä¼šå¯¼è‡´è¶…è¿‡ num
        // ps: æœ€å¤–å±‚ç»´åº¦æ˜¯åˆ¤æ–­ ç¬¬ä¸€ä¸ªæ•°å­—
        if (!arr.includes(currentDigit) || arrayToNumber([...result.slice(0, i), currentDigit, ...new Array(digits - i - 1).fill(0)]) >= num) {
            // ps: å¯»æ‰¾æ¯”å½“å‰æ•°å­—å°çš„æœ€å¤§å¯ç”¨æ•°å­—
            let found = false;
            for (let j = arr.length - 1; j >= 0; j--) {
                if (arr[j] < numArr[i]) {
                    result[i] = arr[j];
                    // å‰©ä½™ä½æ•°å¡«æœ€å¤§å€¼
                    for (let k = i + 1; k < digits; k++) {
                        result[k] = maxDigit;
                    }
                    found = true;
                    break;
                }
            }

            // ps: å¦‚æœæ²¡æ‰¾åˆ°æ›´å°çš„æ•°å­—ï¼Œéœ€è¦å›æº¯
            if (!found) {
                let pos = i - 1;
                while (pos >= 0) {
                    // æ‰¾åˆ°å‰ä¸€ä½å¯ä»¥å˜å°çš„ä½ç½®
                    let prevDigit = result[pos];
                    let smallerDigit = -1;
                    for (let digit of arr) {
                        if (digit < prevDigit && digit <= numArr[pos]) {
                            smallerDigit = digit;
                        }
                    }

                    // å¦‚æœæ‰¾åˆ°äº†
                    if (smallerDigit !== -1) {
                        result[pos] = smallerDigit;
                        // ä» pos + 1 ----> åˆ°æœ€åéƒ½å¡«æœ€å¤§å€¼
                        for (let k = pos + 1; k < digits; k++) {
                            result[k] = maxDigit;
                        }
                        return arrayToNumber(result);
                    }
                    pos--;
                }

                // ps: å¦‚æœä¸€ç›´å›æº¯åˆ°å¼€å¤´éƒ½æ²¡æ‰¾åˆ°ï¼Œå°±å‡å°‘ä¸€ä½ï¼Œç”¨å…¨æœ€å¤§å€¼
                if (pos < 0) {
                    return parseInt(maxDigit.toString().repeat(digits - 1));
                }
            }
        } else {
            // ps: å¦‚æœå½“å‰æ•°å­—å¯ç”¨ï¼Œç›´æ¥ä½¿ç”¨
            result[i] = currentDigit;
        }
    }

    // æœ€ç»ˆéªŒè¯ç»“æœ < num
    const finalResult = arrayToNumber(result);
    return finalResult < num ? finalResult : parseInt(maxDigit.toString().repeat(digits - 1)) || 0;
}

console.log(findMax([9], 1000)) // 999
console.log(findMax([2, 3, 4, 9], 23149)) // 22999
console.log(findMax([2, 3, 4, 9], 23412)) // 23399
// console.log(findMax([9], 999)) // è¿™é‡Œåé¢å†åŠ ä¸Šä¸€å±‚åˆ¤æ–­
```
