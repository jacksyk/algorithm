# â­ 2.finally



## ðŸ“Š é¢˜ç›®æè¿°
æš‚æ— é¢˜ç›®æè¿°

## ðŸ“‹ ä»£ç å®žçŽ°
```typescript
// 1.æ‰¿æŽ¥ä¸Šä¸€æ¬¡Promiseçš„å€¼
// 2.returnçš„å€¼ä¸ä¼šè¢«ä»»ä½•åœ°æ–¹æŽ¥æ”¶
Promise.prototype._finally = function (callback) {
    return this.then(
        (res) => {
            callback()
            return res
        },
        (err) => {
            callback()
            throw err
        }
    )
}

function my(time) {
    return new Promise((resolve, reject) => {
        setTimeout(() => {
            resolve(time)
        }, time)
    })
}
const promise1 = () => my(300)

// promise1()
//     .then((res) => {
//         console.log(res)
//         return "111"
//     })
//     ._finally((res) => {
//         console.log(res)
//         return "hellow"
//     })
//     .then((res) => {
//         console.log("finally", res)
//     })

// promise1()
//     .then((res) => {
//         console.log(res)
//         return "111"
//     })
//     .finally((res) => {
//         console.log(res)
//         return "hellow"
//     })
//     .then((res) => {
//         console.log("finally", res)
//     })
Promise.reject("err")
    .finally(() => {
        console.log("finally")
    })
    .catch(console.log)
    .then((res) => console.log(res))

```
